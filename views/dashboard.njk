{% include "layouts/main.html" %}

{% from "partials/macros.njk" import assessmenttable, assessmentrow, analytics with context %}

<div class="ui container">
    <div class="ui inverted vertical masthead center aligned segment">

        {% include "partials/menu.njk" %}

        <section class="ui segment">
            <div class="column">

                {# See: https://css-tricks.com/killer-features-of-nunjucks/ #}

                {% if user.role == 'member' %}    {### MEMBER #}

                    {{ analytics(user, memberStats) }} {# nunjunks macro #}

                    {% include "partials/addassessment.njk" %}

                        {% if assessmentList %}
                    {{ assessmenttable(assessmentList, user, False, True, False) }}   {# nunjunks macro #}
                        {%  else %}
                    {{  'No assessments found.' }}
                        {% endif %}

                {% elif user.role == 'trainer' %}                  {### TRAINER ###}

                    <div class="ui relaxed divided list">

                        {%- for member in users %}

                            {% if member.role == 'member' %}
                            <div class="item">
                                <i class="large github middle aligned icon"></i>
                                <div class="content">
                                    <div class="header">
                                        <a href="/assessed/{{ member.id }}"> {{ member.name }} </a>
                                        <a href="/dashboard/deletemember/{{ member.id }}">
                                            <i class="ui large red icon trash"></i>
                                        </a>
                                    </div>
                                    <div class="description"> {{ assessmentList.size() if assessmentList else '0' }} assessments </div>
                                </div>
                            </div>
                            {% endif %}

                        {%- endfor %}
                    </div>

                {% else %}
                    {{  'No records found.' }}
                {% endif %}

            </div>
        </section>
    </div>
</div>
