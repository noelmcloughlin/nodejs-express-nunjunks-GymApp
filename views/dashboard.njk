{% include "layouts/main.html" %}

{% from "macros/assessmenttable.njk" import assessmenttable with context %}
{% from "macros/assessmentrow.njk" import assessmentrow with context %}
{% from "macros/analytics.njk" import analytics with context %}

<div class="pusher">
    <div class="ui inverted vertical masthead center aligned segment">

        {% include "partials/menu.njk" %}

        <section class="ui segment">
            <div class="column">

                {# See: https://css-tricks.com/killer-features-of-nunjucks/ #}

                {% if user.role == 'member' %}    {### MEMBER #}

                    {{ analytics(user, memberStats) }} {# nunjunks macro #}

                    {% include "partials/addassessment.njk" %}

                        {% if assessments %}
                    {{ assessmenttable(assessments, user, false, true) }}   {# nunjunks macro #}
                        {%  else %}
                    {{  'No assessments found.' }}
                        {% endif %}

                {% elif user.role == 'trainer' %}                  {### TRAINER ###}

                    <div class="ui relaxed divided list">
                        {%- for member in users %}

                            {% if member.role == 'member' %}
                            <div class="item">
                                <i class="large github middle aligned icon"></i>
                                <div class="content">
                                    <div class="header">
                                        <a href="/assessed/{{ member.id }}"> {{ member.name }} </a>
                                        <a href="/dashboard/deletemember/{{ member.id }}">
                                            <i class="ui large red icon trash"></i>
                                        </a>
                                    </div>
                                    <div class="description"> {{ assessments.size() if assessments else '' }} assessments </div>
                                </div>
                            </div>
                            {% endif %}

                        {%- endfor %}
                    </div>

                {% else %}
                    {{  'No records found.' }}
                {% endif %}

            </div>
        </section>
    </div>
</div>
